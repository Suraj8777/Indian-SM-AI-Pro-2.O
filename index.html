<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>JARVIS AI Assistant</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: 'Arial', sans-serif;
            background: #0a0a0a;
            color: #00ffff;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden;
        }
        .jarvis-container {
            width: 400px;
            background: rgba(0, 0, 0, 0.9);
            padding: 25px;
            border-radius: 15px;
            border: 1px solid #00ffff;
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.4);
            backdrop-filter: blur(5px);
            position: relative;
        }
        #language-select {
            background: rgba(0, 255, 255, 0.1);
            color: #00ffff;
            border: 1px solid #00ffff;
            padding: 8px;
            border-radius: 8px;
            margin-bottom: 15px;
            width: 100%;
            cursor: pointer;
        }
        #status {
            font-size: 1.3em;
            margin-bottom: 15px;
            text-align: center;
            color: #00ffff;
            text-shadow: 0 0 10px #00ffff;
        }
        .output {
            height: 250px;
            overflow-y: auto;
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.6);
            border-radius: 8px;
            border: 1px solid rgba(0, 255, 255, 0.3);
        }
        button {
            background: linear-gradient(45deg, #00ffff, #009999);
            color: #000;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            font-weight: bold;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        button:hover {
            transform: scale(1.03);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.6);
        }
        button:active {
            transform: scale(0.98);
        }
        #background-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
    </style>
</head>
<body>
    <div class="jarvis-container">
        <select id="language-select">
            <option value="en-US">English (US)</option>
            <option value="es-ES">Spanish (Spain)</option>
            <option value="fr-FR">French (France)</option>
            <option value="de-DE">German (Germany)</option>
            <option value="bn-IN">Bengali (India)</option>
            <option value="hi-IN">Hindi (India)</option>
        </select>
        <div id="status">SYSTEM READY</div>
        <div class="output" id="output">JARVIS: Systems online. How may I assist you, sir?</div>
        <button onclick="startListening()">Activate Voice Interface</button>
    </div>
    <canvas id="background-canvas"></canvas>

    <script>
        // Application Logic
        const output = document.getElementById('output');
        const statusDiv = document.getElementById('status');
        const languageSelect = document.getElementById('language-select');
        const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        
        recognition.continuous = false;
        recognition.interimResults = false;
        let appState = 'idle';
        let selectedLanguage = languageSelect.value;
        let lastResponse = '';

        // Language Selection
        languageSelect.addEventListener('change', () => {
            selectedLanguage = languageSelect.value;
        });

        // Command Processing
        const commandSet = [
            { pattern: /time|current time/i, response: () => `The time is ${new Date().toLocaleTimeString()}` },
            { pattern: /date|today's date/i, response: () => `Today is ${new Date().toLocaleDateString()}` },
            { pattern: /who are you/i, response: () => 'I am JARVIS, your artificial intelligence assistant. At your service, sir.' },
            { pattern: /calculate (.+)/i, response: (match) => {
                try {
                    return `Calculation result: ${eval(match[1])}`;
                } catch {
                    return 'Unable to process that calculation';
                }
            }},
            { pattern: /search (.+)/i, response: (match) => {
                window.open(`https://google.com/search?q=${encodeURIComponent(match[1])}`);
                return `Searching for ${match[1]}...`;
            }}
        ];

        // Speech Recognition Handlers
        recognition.onresult = async (event) => {
            const transcript = event.results[0][0].transcript;
            output.innerHTML += `<div class="user-query">USER: ${transcript}</div>`;
            setStatus('PROCESSING QUERY');
            appState = 'processing';

            let response = processCommand(transcript);
            if (!response) {
                response = await fetchAIResponse(transcript);
            }

            output.innerHTML += `<div class="jarvis-response">JARVIS: ${response}</div>`;
            output.scrollTop = output.scrollHeight;
            lastResponse = response;
            speak(response);
            setStatus('SYSTEM READY');
            appState = 'idle';
        };

        recognition.onerror = (event) => {
            output.innerHTML += `<div class="error">SYSTEM ERROR: ${event.error}</div>`;
            setStatus('SYSTEM READY');
            appState = 'idle';
        };

        // Helper Functions
        function processCommand(transcript) {
            for (const cmd of commandSet) {
                const match = transcript.match(cmd.pattern);
                if (match) return cmd.response(match);
            }
            return null;
        }

        async function fetchAIResponse(query) {
            try {
                const response = await fetch('https://api.openrouter.ai/api/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer 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`, // Replace with your API key
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: 'meta-llama/llama-3.1-8b-instruct:free',
                        messages: [{
                            role: 'system',
                            content: `Respond as JARVIS from Iron Man. Be concise and technical. Current language: ${selectedLanguage}`
                        }, {
                            role: 'user',
                            content: query
                        }]
                    })
                });

                if (!response.ok) {
                    throw new Error(`API Error: ${response.status}`);
                }

                const data = await response.json();
                return data.choices[0].message.content;
            } catch (error) {
                console.error('AI Fetch Error:', error);
                return 'I apologize, sir. My neural network is currently unavailable. Please try again later.';
            }
        }

        function startListening() {
            recognition.lang = selectedLanguage;
            setStatus('LISTENING');
            appState = 'listening';
            recognition.start();
        }

        function setStatus(text) {
            statusDiv.textContent = text;
            statusDiv.style.textShadow = `0 0 15px ${appState === 'listening' ? '#ff0000' : '#00ffff'}`;
        }

        function speak(text) {
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.voice = speechSynthesis.getVoices()
                .find(voice => voice.lang === selectedLanguage) || speechSynthesis.getVoices()[0];
            speechSynthesis.speak(utterance);
        }

        // Enhanced Background Animation
        const canvas = document.getElementById('background-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        class Particle {
            constructor() {
                this.reset(true);
                this.hue = Math.random() * 360;
                this.alpha = 0.1 + Math.random() * 0.3;
                this.trail = [];
                this.maxTrail = 10;
            }

            reset(init) {
                this.x = init ? Math.random() * canvas.width : -100;
                this.y = Math.random() * canvas.height;
                this.vx = (Math.random() - 0.5) * (appState === 'listening' ? 5 : 2);
                this.vy = (Math.random() - 0.5) * (appState === 'listening' ? 5 : 2);
                this.baseSize = 2 + Math.random() * 3;
            }

            update() {
                this.vx *= 0.99;
                this.vy *= 0.99;
                
                const speed = appState === 'listening' ? 1.5 : appState === 'processing' ? 0.6 : 1;
                this.x += this.vx * speed;
                this.y += this.vy * speed;

                this.trail.push({x: this.x, y: this.y});
                if (this.trail.length > this.maxTrail) this.trail.shift();

                if (this.x < -100 || this.x > canvas.width + 100 || 
                    this.y < -100 || this.y > canvas.height + 100) this.reset(false);
            }

            draw() {
                this.trail.forEach((pos, i) => {
                    const ratio = i/this.trail.length;
                    ctx.beginPath();
                    ctx.arc(pos.x, pos.y, this.baseSize * ratio, 0, Math.PI * 2);
                    ctx.fillStyle = `hsla(${this.hue}, 100%, 50%, ${this.alpha * ratio})`;
                    ctx.fill();
                });

                ctx.beginPath();
                ctx.arc(this.x, this.y, this.baseSize, 0, Math.PI * 2);
                ctx.fillStyle = `hsla(${this.hue}, 100%, 50%, ${this.alpha})`;
                ctx.fill();
            }
        }

        const particles = Array.from({length: 200}, () => new Particle());

        function animate() {
            ctx.fillStyle = 'rgba(10, 10, 10, 0.05)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            particles.forEach(particle => {
                particle.update();
                particle.draw();
            });

            drawConnections();
            requestAnimationFrame(animate);
        }

        function drawConnections() {
            particles.forEach((a, i) => {
                particles.slice(i).forEach(b => {
                    const dx = a.x - b.x;
                    const dy = a.y - b.y;
                    const dist = Math.sqrt(dx*dx + dy*dy);

                    if (dist < 150) {
                        ctx.beginPath();
                        ctx.moveTo(a.x, a.y);
                        ctx.lineTo(b.x, b.y);
                        ctx.strokeStyle = `hsla(${(a.hue + b.hue)/2}, 70%, 50%, ${0.3 - dist/500})`;
                        ctx.lineWidth = 1.5 - dist/100;
                        ctx.stroke();
                    }
                });
            });
        }

        animate();

        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            particles.forEach(p => p.reset(true));
        });

        canvas.addEventListener('mousemove', (e) => {
            if (appState === 'idle') {
                particles.forEach(p => {
                    const dx = e.x - p.x;
                    const dy = e.y - p.y;
                    const dist = Math.sqrt(dx*dx + dy*dy);
                    if (dist < 150) {
                        p.vx += dx * 0.0003;
                        p.vy += dy * 0.0003;
                    }
                });
            }
        });

        // Initialize voices
        window.speechSynthesis.onvoiceschanged = () => {
            speak('All systems operational. Awaiting your command.');
        };
    </script>
</body>
</html>
